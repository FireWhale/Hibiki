<% content_for :title do %><%= name_language_helper(@album,current_user,0, :no_bold => true) %><% end %>

<% content_for :header do %>
  <div class="text-center">
    <h2><%= name_language_helper(@album,current_user,0, :no_bold => true) %></h2>
    <h4><%= name_language_helper(@album,current_user,1, :no_bold => true) %>
        <% if name_language_helper(@album,current_user,2, :no_bold => true).nil? == false %>
          / <%= name_language_helper(@album,current_user,2, :no_bold => true) %>
        <% end %>
    </h4> 
  </div>
<% end %>

<p id="notice"><%= notice %></p>

<div class="row">
  <div class="col-md-4">
    <%= render :partial => "layouts/show_primary_image", :locals => {:record => @album} %>
    <div id="Attributes" class="well">
      <%= attribute_display(@album, 'status', "Status") if can? :manage, Album %>
      <%= attribute_display(@album, "catalog_number", "Catalog Number" ) %>
      <%= attribute_display(@album, "release_date", "Release Date" ) %>
      <% @related.each do |k,v| %><%= linked_attribute_display(v,k) %><% end %>    
      <%= reference_helper(@album) %>  
      <%= linked_attribute_display(@album.events, "Events") %>
      <%= linked_attribute_display(@album.tags, "Tags")%>
    </div>
    <%= render :partial => "layouts/maintenance/admin_actions", :locals => {:record => @album} %>
  </div>
  
  <div class="col-md-8">
    <div id="People" class="well">
      <h4 class="text-center">Artists and Organizations</h4>
      <% @credits.each do |k,v| %><%= linked_attribute_display(v,k)%><% end %>
      <% @organizations.each do |k,v| %><%= linked_attribute_display(v,k)%><% end %>
    </div>
    <% if @album.sources.empty? == false%>
      <div id="Sources" class="well">
        <h4 class="text-center">Source Material</h4>
          <%= linked_attribute_display(@album.sources, '') %>
      </div>
    <% end %>
    <div id="Tracklist" class="well">
      <h4 class="text-center">Tracklist <% if can? :read, @album %><%= link_to "(Export)", tracklist_export_album_path%><% end %></h4>
      <% if @album.songs.empty? == false%>
          <% @album.songs.each do |each|%>  
            <div class="row tracksong">
              <div class="col-md-1">
                <%= link_to "Expand", songpreview_path(:songid => each.id), :remote => true, class: "label label-default" , :id => each.id.to_s + "Show" %>
                <%= link_to "Collapse", songpreviewhide_path(:id => each.id), :remote => true, class: "label label-default" , :style => 'display: none', :id => each.id.to_s + "Hide"  %> 
              </div>
              <div class="col-md-1"><%= each.track_number %></div>
              <div class='col-md-9'><%= name_language_helper(each,current_user,0) %></div>
              <td><%= Time.at(each.length).utc.strftime("%-M:%S") if each.length.nil? == false%></td>
            </div>
            <div class="Songpreviews" id="<%= each.id %>"></div>
          <% end %>
      <% else %>
        <h6>No Tracklist available</h6>
      <% end %>
    </div>
    <% if @album.info.nil? == false %>
      <% if @album.info.empty? == false %>
        <div id="Info" class="well">
          <h4 class="text-center">Information</h4>
          <%= simple_format(@album.info) %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>   

<% content_for :usersidebar do %>
  <% if current_user %>
    <div class="well">
      <% if @album.collected?(current_user) || @album.ignored?(current_user)  || @album.wishlist?(current_user)  %>
        <div id = "CollectLink">This album is <%= @album.collections.where(:user_id => current_user.id).first.relationship %> <br>
        <%= link_to "Remove from collection/ignore list?", uncollect_path(:user_id => current_user.id, :album_id => @album.id), :remote => true %>
        </div>
      <% else %>
        <div id="CollectLink">
          <%= link_to "Add to Collection", add_to_collection_path(:user_id => current_user.id, :album_id => @album.id, :relationship => 'Collected'), :remote => true %><br>
          <%= link_to "Ignore This Album", add_to_collection_path(:user_id => current_user.id, :album_id => @album.id, :relationship => 'Ignored'), :remote => true %><br> 
          <%= link_to "Add to Wishlist", add_to_collection_path(:user_id => current_user.id, :album_id => @album.id, :relationship => 'Wishlist'), :remote => true %>    
        </div>
      <% end %>
      <% if can? :manage, Album %>
        <br><%= attribute_display(@album, "created_at", "Created at" ) %>
        <%= render :partial => 'tags/edit_tags', locals: {:subject => @album } %>
      <% end %>    
    </div>
  <% end %>
<% end %>

      
  
